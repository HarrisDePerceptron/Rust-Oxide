        <section id="routing" data-nav-title="Routing" class="doc-section fade-2 mx-auto mt-14 max-w-3xl space-y-4">
          <h2 class="flex items-center gap-3 font-display text-3xl leading-tight text-[color:var(--pine)] sm:text-4xl">
            <span class="h-2.5 w-2.5 rounded-full bg-[color:var(--clay)]"></span>
            Routing
          </h2>
          <h3 class="text-lg font-semibold leading-tight text-[color:var(--pine)] sm:text-xl">Wrap a service, expose CRUD endoints, or Don't!</h3>
          <p class="text-sm text-black/70">
            The file <span class="font-semibold">src/routes/base_api_router.rs</span> provides
            <span class="font-semibold">CrudApiRouter</span>. Hand it a service that implements
            <span class="font-semibold">CrudService</span> and a base path, and you get five
            JSON endpoints by default.
          </p>
          <div class="rounded-3xl border border-black/10 bg-white/95 p-6 shadow-xl shadow-black/5">
            <p class="text-xs uppercase tracking-[0.3em] text-black/50">Quick setup</p>
            <pre
              class="mt-4 overflow-x-auto rounded-2xl bg-[color:var(--mist)] p-4 text-xs text-[color:var(--pine)]"
            ><code>// src/routes/api/todo_crud.rs
use crate::auth::Role;
use crate::middleware::AuthRolGuardLayer;
use crate::routes::base_api_router::{CrudApiRouter, Method};
use crate::services::ServiceContext;

let service = ServiceContext::from_state(state.as_ref()).todo();
let router = CrudApiRouter::new(service, "/todo-crud")
    .set_method_middleware(
        Method::Create,
        AuthRolGuardLayer::new(state.clone(), Role::User),
    )
    .router();</code></pre>
            <p class="mt-4 text-sm text-black/60">
              Keep handlers thin. Customize list ordering and filtering through the service
              and override list hooks in the router if needed.
            </p>
          </div>
          <div class="rounded-2xl border border-black/10 bg-white/90 p-4 text-xs text-black/70">
            <p class="font-semibold text-[color:var(--pine)]">Default endpoints</p>
            <pre class="mt-3 overflow-x-auto rounded-xl bg-[color:var(--mist)] p-3 text-xs text-[color:var(--pine)]"><code># http
POST /base
GET /base
GET /base/{id}
PATCH /base/{id}
DELETE /base/{id}</code></pre>
            <p class="mt-2 text-black/50">IDs are UUIDs in this template.</p>
          </div>
          <div class="rounded-2xl border border-black/10 bg-[color:var(--mist)]/60 p-4 text-xs text-black/70">
            <p class="font-semibold text-[color:var(--pine)]">Pagination defaults</p>
            <pre class="mt-3 overflow-x-auto rounded-xl bg-white/80 p-3 text-xs text-[color:var(--pine)]"><code># query params
?page=1&page_size=25</code></pre>
            <p class="mt-2 text-black/50">Max page_size is 100.</p>
          </div>
          <div class="rounded-2xl border border-black/10 bg-white/90 p-4 text-xs text-black/70">
            <p class="font-semibold text-[color:var(--pine)]">Extension points</p>
            <pre class="mt-3 overflow-x-auto rounded-xl bg-[color:var(--mist)] p-3 text-xs text-[color:var(--pine)]"><code>// src/routes/api/your_router.rs
use axum::routing::{get, post};
use sea_orm::{ColumnTrait, Order, QueryFilter};
use crate::middleware::AuthGuard;
use crate::routes::base_api_router::{CrudApiRouter, Method, ListQuery};

async fn create_todo(_auth: AuthGuard) {
    // ...
}

let router = CrudApiRouter::new(service, "/todos")
    .set_allowed_methods(&[Method::Create, Method::List, Method::Get])
    .router()
    .route("/todos", post(create_todo))
    .route("/todos", get(list_todos));

fn list_order() -> Option<(Column, Order)> {
    Some((Column::CreatedAt, Order::Desc))
}

fn list_apply(query: &ListQuery, select: Select<Entity>) -> Select<Entity> {
    if let Some(owner_id) = query.filters.get("owner_id") {
        select.filter(Column::OwnerId.eq(owner_id.as_str()))
    } else {
        select
    }
}</code></pre>
          </div>
        </section>
