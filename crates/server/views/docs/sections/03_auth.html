        <section id="auth" data-nav-title="Authentication" class="doc-section fade-2 mx-auto mt-14 max-w-3xl space-y-4">
          <h2 class="flex items-center gap-3 font-display text-3xl leading-tight text-[color:var(--pine)] sm:text-4xl">
            <span class="h-2.5 w-2.5 rounded-full bg-[color:var(--clay)]"></span>
            Authentication
          </h2>
          <h3 class="text-lg font-semibold leading-tight text-[color:var(--pine)] sm:text-xl">Register, get a token, protect routes.</h3>
          <p class="text-sm text-black/70">
            The auth router provides <span class="font-semibold">/api/v1/register</span>,
            <span class="font-semibold">/api/v1/login</span>, and <span class="font-semibold">/api/v1/refresh</span>.
            Use the access token as a Bearer token to call protected endpoints.
          </p>
          <div class="rounded-3xl border border-black/10 bg-white/95 p-6 shadow-xl shadow-black/5">
            <p class="text-xs uppercase tracking-[0.3em] text-black/50">Get tokens</p>
            <div
              class="mt-4 rounded-2xl border border-black/10 shadow-inner"
              data-terminal="true"
              style="background-color: var(--pine); color: var(--mist);"
            >
              <div class="flex items-center justify-between border-b border-white/10 px-4 py-2 text-[10px] uppercase tracking-[0.3em] text-white/70">
                <span>Terminal</span>
                <button
                  class="rounded-full border border-white/20 px-3 py-1 text-[10px] font-semibold uppercase tracking-[0.25em] text-white/70 transition hover:border-white/40 hover:text-white"
                  data-copy-target="terminal-auth-tokens"
                  type="button"
                >
                  Copy
                </button>
              </div>
              <pre class="overflow-x-auto px-4 py-4 text-xs text-white"><code id="terminal-auth-tokens"># register
curl -X POST http://localhost:3000/api/v1/register \\
  -H "Content-Type: application/json" \\
  -d '{"email":"you@example.com","password":"password123"}'

# login
curl -X POST http://localhost:3000/api/v1/login \\
  -H "Content-Type: application/json" \\
  -d '{"email":"you@example.com","password":"password123"}'</code></pre>
            </div>
          </div>
          <div class="rounded-3xl border border-black/10 bg-white/95 p-6 shadow-xl shadow-black/5">
            <p class="text-xs uppercase tracking-[0.3em] text-black/50">Call a protected route</p>
            <div
              class="mt-4 rounded-2xl border border-black/10 shadow-inner"
              data-terminal="true"
              style="background-color: var(--pine); color: var(--mist);"
            >
              <div class="flex items-center justify-between border-b border-white/10 px-4 py-2 text-[10px] uppercase tracking-[0.3em] text-white/70">
                <span>Terminal</span>
                <button
                  class="rounded-full border border-white/20 px-3 py-1 text-[10px] font-semibold uppercase tracking-[0.25em] text-white/70 transition hover:border-white/40 hover:text-white"
                  data-copy-target="terminal-protected-route"
                  type="button"
                >
                  Copy
                </button>
              </div>
              <pre class="overflow-x-auto px-4 py-4 text-xs text-white"><code id="terminal-protected-route"># /api/v1/me is protected
curl http://localhost:3000/api/v1/me \\
  -H "Authorization: Bearer $ACCESS_TOKEN"</code></pre>
            </div>
          </div>
          <div class="rounded-3xl border border-black/10 bg-white/95 p-6 shadow-xl shadow-black/5">
            <p class="text-xs uppercase tracking-[0.3em] text-black/50">Minimal route protection</p>
            <pre class="mt-4 overflow-x-auto rounded-2xl bg-[color:var(--mist)] p-4 text-xs text-[color:var(--pine)]"><code>// src/routes/api/protected.rs
use axum::{Router, routing::get};
use std::sync::Arc;
use crate::middleware::AuthGuard;
use crate::state::AppState;

pub fn router(state: Arc<AppState>) -> Router {
    Router::new()
        .route("/me", get(me))
        .with_state(state)
}

async fn me(_auth: AuthGuard) {
    // ...
}</code></pre>
          </div>
          <div class="rounded-3xl border border-black/10 bg-white/95 p-6 shadow-xl shadow-black/5">
            <p class="text-xs uppercase tracking-[0.3em] text-black/50">Role-based protection</p>
            <pre class="mt-4 overflow-x-auto rounded-2xl bg-[color:var(--mist)] p-4 text-xs text-[color:var(--pine)]"><code>// src/routes/api/admin.rs
use axum::{Router, routing::get};
use std::sync::Arc;
use crate::middleware::{AdminRole, AuthRoleGuard};
use crate::state::AppState;

pub fn router(state: Arc<AppState>) -> Router {
    Router::new()
        .route("/admin/stats", get(admin_stats))
        .with_state(state)
}

async fn admin_stats(AuthRoleGuard { .. }: AuthRoleGuard<AdminRole>) {
    // ...
}</code></pre>
          </div>
          <div class="rounded-3xl border border-black/10 bg-white/95 p-6 shadow-xl shadow-black/5">
            <p class="text-xs uppercase tracking-[0.3em] text-black/50">Role per route</p>
            <pre class="mt-4 overflow-x-auto rounded-2xl bg-[color:var(--mist)] p-4 text-xs text-[color:var(--pine)]"><code>// src/routes/api/protected.rs
use axum::{Router, routing::get};
use std::sync::Arc;
use crate::middleware::{AdminRole, AuthRoleGuard, UserRole};
use crate::state::AppState;

pub fn router(state: Arc<AppState>) -> Router {
    Router::new()
        .route("/reports", get(reports))
        .route("/admin/stats", get(admin_stats))
        .with_state(state)
}

async fn reports(_auth: AuthRoleGuard<UserRole>) {
    // ...
}

async fn admin_stats(_auth: AuthRoleGuard<AdminRole>) {
    // ...
}</code></pre>
          </div>
          <div class="rounded-3xl border border-black/10 bg-white/95 p-6 shadow-xl shadow-black/5">
            <p class="text-xs uppercase tracking-[0.3em] text-black/50">Auth providers</p>
            <p class="mt-3 text-sm text-black/70">
              Auth is provider-driven. The active provider is selected by <span class="font-semibold">AUTH_PROVIDER</span>
              and registered in <span class="font-semibold">src/auth/bootstrap.rs</span>.
              Route handlers use the auth service, and auth guards verify tokens through the active provider.
            </p>
            <pre class="mt-4 overflow-x-auto rounded-2xl bg-[color:var(--mist)] p-4 text-xs text-[color:var(--pine)]"><code>// src/auth/providers/your_provider.rs
use async_trait::async_trait;
use crate::auth::{Claims, TokenBundle};
use crate::auth::providers::{AuthProvider, AuthProviderId};

pub struct YourProvider;

#[async_trait]
impl AuthProvider for YourProvider {
    fn id(&self) -> AuthProviderId { /* ... */ }
    async fn register(&self, email: &str, password: &str) -> Result<TokenBundle, AppError> { /* ... */ }
    async fn login(&self, email: &str, password: &str) -> Result<TokenBundle, AppError> { /* ... */ }
    async fn refresh(&self, refresh_token: &str) -> Result<TokenBundle, AppError> { /* ... */ }
    async fn verify(&self, access_token: &str) -> Result<Claims, AppError> { /* ... */ }
}</code></pre>
            <pre class="mt-4 overflow-x-auto rounded-2xl bg-[color:var(--mist)] p-4 text-xs text-[color:var(--pine)]"><code>// src/auth/bootstrap.rs
let mut providers = AuthProviders::new(cfg.auth_provider)
    .with_provider(std::sync::Arc::new(YourProvider::new(/* deps */)))?;
providers.set_active(cfg.auth_provider)?;</code></pre>
            <p class="mt-3 text-xs text-black/60">
              Add provider-specific env vars, then set <span class="font-semibold">AUTH_PROVIDER</span> to switch.
            </p>
          </div>
        </section>
